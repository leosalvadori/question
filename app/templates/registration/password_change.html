{% extends 'base.html' %}
{% block title %}SGP - Alterar Senha{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto space-y-6">
  <!-- Header Section -->
  <div class="text-center">
    <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-blue-400 bg-clip-text text-transparent">
      Alterar Senha
    </h1>
    <p class="text-muted-foreground mt-2">Mude sua senha para manter sua conta segura</p>
  </div>

  <!-- Back to Profile Link -->
  <div class="flex items-center">
    <a 
      href="{% url 'profile' %}" 
      class="inline-flex items-center space-x-2 text-muted-foreground hover:text-primary transition-colors duration-200 group"
    >
      <i data-lucide="arrow-left" class="w-4 h-4 group-hover:-translate-x-1 transition-transform duration-200"></i>
      <span class="text-sm">Voltar ao Perfil</span>
    </a>
  </div>

  <!-- Password Change Card -->
  <div class="relative overflow-hidden rounded-lg border border-border bg-card glass-effect">
    <!-- Animated background -->
    <div class="absolute inset-0 bg-gradient-to-br from-blue-500/5 via-purple-500/5 to-cyan-500/5"></div>
    
    <div class="relative p-8">
      <div class="flex items-center space-x-3 mb-8">
        <div class="w-12 h-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center animate-glow">
          <i data-lucide="shield-check" class="w-6 h-6 text-white"></i>
        </div>
        <div>
          <h2 class="text-xl font-semibold">Segurança da Conta</h2>
          <p class="text-sm text-muted-foreground">Mantenha sua conta protegida com uma senha forte</p>
        </div>
      </div>

      <!-- Success Message -->
      {% if messages %}
        {% for message in messages %}
          <div class="mb-6 p-4 rounded-md border border-green-500/50 bg-green-500/10">
            <div class="flex items-center space-x-2">
              <i data-lucide="check-circle" class="h-4 w-4 text-green-500"></i>
              <p class="text-sm text-green-400">{{ message }}</p>
            </div>
          </div>
        {% endfor %}
      {% endif %}

      <!-- Password Change Form -->
      <form method="post" class="space-y-6">
        {% csrf_token %}
        
        <!-- Current Password Field -->
        <div class="space-y-2">
          <label for="old_password" class="text-sm font-medium leading-none">
            Senha Atual
          </label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i data-lucide="lock" class="h-4 w-4 text-muted-foreground"></i>
            </div>
            <input 
              type="password" 
              id="old_password" 
              name="old_password" 
              required
              class="flex h-10 w-full rounded-md border border-input bg-background pl-10 pr-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200"
              placeholder="Digite sua senha atual"
            >
          </div>
          {% if form.old_password.errors %}
            <div class="text-xs text-destructive">
              {% for error in form.old_password.errors %}
                <p>{{ error }}</p>
              {% endfor %}
            </div>
          {% endif %}
          <p class="text-xs text-muted-foreground">Digite sua senha atual para confirmar a alteração</p>
        </div>

        <!-- New Password Field -->
        <div class="space-y-2">
          <label for="new_password1" class="text-sm font-medium leading-none">
            Nova Senha
          </label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i data-lucide="key" class="h-4 w-4 text-muted-foreground"></i>
            </div>
            <input 
              type="password" 
              id="new_password1" 
              name="new_password1" 
              required
              class="flex h-10 w-full rounded-md border border-input bg-background pl-10 pr-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200"
              placeholder="Digite sua nova senha"
            >
          </div>
          {% if form.new_password1.errors %}
            <div class="text-xs text-destructive">
              {% for error in form.new_password1.errors %}
                <p>{{ error }}</p>
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <!-- New Password Confirmation Field -->
        <div class="space-y-2">
          <label for="new_password2" class="text-sm font-medium leading-none">
            Confirmar Nova Senha
          </label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i data-lucide="shield" class="h-4 w-4 text-muted-foreground"></i>
            </div>
            <input 
              type="password" 
              id="new_password2" 
              name="new_password2" 
              required
              class="flex h-10 w-full rounded-md border border-input bg-background pl-10 pr-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200"
              placeholder="Confirme sua nova senha"
            >
          </div>
          {% if form.new_password2.errors %}
            <div class="text-xs text-destructive">
              {% for error in form.new_password2.errors %}
                <p>{{ error }}</p>
              {% endfor %}
            </div>
          {% endif %}
          <p class="text-xs text-muted-foreground">Digite novamente sua nova senha para confirmação</p>
        </div>

        <!-- Password Requirements -->
        <div class="p-4 rounded-md border border-blue-500/20 bg-blue-500/5">
          <div class="flex items-center space-x-2 mb-2">
            <i data-lucide="info" class="h-4 w-4 text-blue-400"></i>
            <h4 class="text-sm font-medium text-blue-400">Requisitos da Senha</h4>
          </div>
          <ul class="text-xs text-muted-foreground space-y-1 ml-6">
            <li>• Mínimo de 8 caracteres</li>
            <li>• Não pode ser muito comum</li>
            <li>• Não pode ser apenas numérica</li>
            <li>• Não pode ser muito similar às suas informações pessoais</li>
          </ul>
        </div>

        <!-- Action Buttons -->
        <div class="flex items-center justify-between pt-4">
          <a 
            href="{% url 'profile' %}" 
            class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"
          >
            <i data-lucide="x" class="w-4 h-4 mr-2"></i>
            Cancelar
          </a>
          
          <button 
            type="submit" 
            class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-6 py-2 group"
          >
            <i data-lucide="shield-check" class="w-4 h-4 mr-2 group-hover:scale-110 transition-transform duration-200"></i>
            Alterar Senha
          </button>
        </div>
      </form>

      <!-- Form Errors -->
      {% if form.errors %}
        <div class="mt-6 p-4 rounded-md border border-destructive/50 bg-destructive/10">
          <div class="flex items-center space-x-2 mb-2">
            <i data-lucide="alert-circle" class="h-4 w-4 text-destructive"></i>
            <h3 class="text-sm font-medium text-destructive">Erro ao alterar senha</h3>
          </div>
          <ul class="text-sm text-destructive-foreground space-y-1">
            {% for field in form %}
              {% for error in field.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- Security Tips Card -->
  <div class="relative overflow-hidden rounded-lg border border-border bg-card glass-effect">
    <div class="absolute inset-0 bg-gradient-to-br from-green-500/5 via-blue-500/5 to-cyan-500/5"></div>
    
    <div class="relative p-6">
      <div class="flex items-center space-x-3 mb-4">
        <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-blue-500 rounded-lg flex items-center justify-center">
          <i data-lucide="lightbulb" class="w-4 h-4 text-white"></i>
        </div>
        <h3 class="text-lg font-semibold">Dicas de Segurança</h3>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
        <div class="flex items-start space-x-2">
          <i data-lucide="check" class="w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"></i>
          <p class="text-muted-foreground">Use uma combinação de letras, números e símbolos</p>
        </div>
        <div class="flex items-start space-x-2">
          <i data-lucide="check" class="w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"></i>
          <p class="text-muted-foreground">Evite informações pessoais óbvias</p>
        </div>
        <div class="flex items-start space-x-2">
          <i data-lucide="check" class="w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"></i>
          <p class="text-muted-foreground">Altere sua senha regularmente</p>
        </div>
        <div class="flex items-start space-x-2">
          <i data-lucide="check" class="w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"></i>
          <p class="text-muted-foreground">Não compartilhe sua senha com ninguém</p>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}